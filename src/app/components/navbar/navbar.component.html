<div *ngIf="isLoggedIn" class="sidebar bg-blue-800 text-white h-screen w-64 fixed left-0 top-0 shadow-lg transition-all duration-300 z-50"
     [class.collapsed]="isCollapsed">

  <!-- En-tête du sidebar -->
  <div class="sidebar-header p-4 border-b border-blue-700 flex items-center justify-between">
    <!-- Logo -->
    <div class="flex items-center" *ngIf="!isCollapsed">
      <i class="fas fa-heart text-xl text-blue-200 mr-3"></i>
      <span class="font-bold text-lg">MediCare</span>
    </div>

    <!-- Bouton toggle -->
    <button
      (click)="toggleSidebar()"
      class="text-blue-200 hover:text-white p-2 rounded-lg hover:bg-blue-700 transition-colors">
      <i class="fas" [class.fa-bars]="!isCollapsed" [class.fa-times]="isCollapsed"></i>
    </button>
  </div>

  <!-- Profil utilisateur -->
  <div *ngIf="isLoggedIn && !isCollapsed" class="user-profile p-4 border-b border-blue-700">
    <div class="flex items-center space-x-3">
      <div class="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center">
        <i class="fas fa-user text-white"></i>
      </div>
      <div class="flex-1 min-w-0">
        <p class="font-medium text-white truncate">{{ userName || 'Utilisateur' }}</p>
        <p class="text-blue-200 text-sm truncate">{{ userEmail }}</p>
        <span class="bg-blue-600 text-blue-100 text-xs px-2 py-1 rounded-full mt-1 inline-block">
          {{ userRoleLabel }}
        </span>
      </div>
    </div>
  </div>

  <!-- Navigation -->
  <nav class="sidebar-nav p-4 space-y-2 overflow-y-auto flex-1">

    <!-- Tableau de bord -->
    <a *ngIf="isLoggedIn"
       class="nav-item flex items-center px-3 py-3 rounded-lg text-blue-100 hover:bg-blue-700 hover:text-white transition-colors"
       routerLink="/dashboard"
       routerLinkActive="bg-blue-900 text-white">
      <i class="fas fa-home w-5 mr-3 text-center"></i>
      <span *ngIf="!isCollapsed" class="font-medium">Dashboard</span>
    </a>

    <!-- Section Administration -->
    <div *ngIf="isAdmin && isLoggedIn">
      <!-- Titre section -->
      <div *ngIf="!isCollapsed" class="section-title px-3 py-2 text-blue-300 text-sm font-semibold uppercase tracking-wider">
        Administration
      </div>

      <a class="nav-item flex items-center px-3 py-3 rounded-lg text-blue-100 hover:bg-blue-700 hover:text-white transition-colors"
         routerLink="/users"
         routerLinkActive="bg-blue-900 text-white">
        <i class="fas fa-users w-5 mr-3 text-center"></i>
        <span *ngIf="!isCollapsed">Utilisateurs</span>
      </a>

      <a class="nav-item flex items-center px-3 py-3 rounded-lg text-blue-100 hover:bg-blue-700 hover:text-white transition-colors"
         routerLink="/medecins"
         routerLinkActive="bg-blue-900 text-white">
        <i class="fas fa-user-md w-5 mr-3 text-center"></i>
        <span *ngIf="!isCollapsed">Médecins</span>
      </a>

      <a class="nav-item flex items-center px-3 py-3 rounded-lg text-blue-100 hover:bg-blue-700 hover:text-white transition-colors"
         routerLink="/secretaires"
         routerLinkActive="bg-blue-900 text-white">
        <i class="fas fa-id-card w-5 mr-3 text-center"></i>
        <span *ngIf="!isCollapsed">Secrétaires</span>
      </a>

      <a class="nav-item flex items-center px-3 py-3 rounded-lg text-blue-100 hover:bg-blue-700 hover:text-white transition-colors"
         routerLink="/patients"
         routerLinkActive="bg-blue-900 text-white">
        <i class="fas fa-user w-5 mr-3 text-center"></i>
        <span *ngIf="!isCollapsed">Patients</span>
      </a>

      <a class="nav-item flex items-center px-3 py-3 rounded-lg text-blue-100 hover:bg-blue-700 hover:text-white transition-colors"
         routerLink="/specialites"
         routerLinkActive="bg-blue-900 text-white">
        <i class="fas fa-briefcase w-5 mr-3 text-center"></i>
        <span *ngIf="!isCollapsed">Spécialités</span>
      </a>

      <a class="nav-item flex items-center px-3 py-3 rounded-lg text-blue-100 hover:bg-blue-700 hover:text-white transition-colors"
         routerLink="/departements"
         routerLinkActive="bg-blue-900 text-white">
        <i class="fas fa-building w-5 mr-3 text-center"></i>
        <span *ngIf="!isCollapsed">Départements</span>
      </a>
    </div>

    <!-- Section Secrétaire -->
    <div *ngIf="isSecretaire && isLoggedIn">
      <div *ngIf="!isCollapsed" class="section-title px-3 py-2 text-blue-300 text-sm font-semibold uppercase tracking-wider">
        Secrétariat
      </div>

      <a class="nav-item flex items-center px-3 py-3 rounded-lg text-blue-100 hover:bg-blue-700 hover:text-white transition-colors"
         routerLink="/rendez-vous"
         routerLinkActive="bg-blue-900 text-white">
        <i class="fas fa-calendar w-5 mr-3 text-center"></i>
        <span *ngIf="!isCollapsed">Rendez-vous</span>
      </a>

      <a class="nav-item flex items-center px-3 py-3 rounded-lg text-blue-100 hover:bg-blue-700 hover:text-white transition-colors"
         routerLink="/dossiers-medicaux"
         routerLinkActive="bg-blue-900 text-white">
        <i class="fas fa-folder w-5 mr-3 text-center"></i>
        <span *ngIf="!isCollapsed">Dossiers médicaux</span>
      </a>

      <a class="nav-item flex items-center px-3 py-3 rounded-lg text-blue-100 hover:bg-blue-700 hover:text-white transition-colors"
         routerLink="/paiements"
         routerLinkActive="bg-blue-900 text-white">
        <i class="fas fa-money-bill w-5 mr-3 text-center"></i>
        <span *ngIf="!isCollapsed">Paiements</span>
      </a>
    </div>

    <!-- Section Médecin -->
    <div *ngIf="isMedecin && isLoggedIn">
      <div *ngIf="!isCollapsed" class="section-title px-3 py-2 text-blue-300 text-sm font-semibold uppercase tracking-wider">
        Médical
      </div>

      <a class="nav-item flex items-center px-3 py-3 rounded-lg text-blue-100 hover:bg-blue-700 hover:text-white transition-colors"
         routerLink="/mes-med-patients"
         routerLinkActive="bg-blue-900 text-white">
        <i class="fas fa-user w-5 mr-3 text-center"></i>
        <span *ngIf="!isCollapsed">Patients</span>
      </a>

      <a class="nav-item flex items-center px-3 py-3 rounded-lg text-blue-100 hover:bg-blue-700 hover:text-white transition-colors"
         routerLink="/mes-rv"
         routerLinkActive="bg-blue-900 text-white">
        <i class="fas fa-calendar w-5 mr-3 text-center"></i>
        <span *ngIf="!isCollapsed">Rendez-vous</span>
      </a>

      <a class="nav-item flex items-center px-3 py-3 rounded-lg text-blue-100 hover:bg-blue-700 hover:text-white transition-colors"
         routerLink="/mes-med-consultations"
         routerLinkActive="bg-blue-900 text-white">
        <i class="fas fa-file-medical w-5 mr-3 text-center"></i>
        <span *ngIf="!isCollapsed">Consultations</span>
      </a>

      <a class="nav-item flex items-center px-3 py-3 rounded-lg text-blue-100 hover:bg-blue-700 hover:text-white transition-colors"
         routerLink="/dossier-med-medicaux"
         routerLinkActive="bg-blue-900 text-white">
        <i class="fas fa-folder w-5 mr-3 text-center"></i>
        <span *ngIf="!isCollapsed">Dossiers médicaux</span>
      </a>

      <a class="nav-item flex items-center px-3 py-3 rounded-lg text-blue-100 hover:bg-blue-700 hover:text-white transition-colors"
         routerLink="/compte-med-rendus"
         routerLinkActive="bg-blue-900 text-white">
        <i class="fas fa-file-alt w-5 mr-3 text-center"></i>
        <span *ngIf="!isCollapsed">Comptes-rendus</span>
      </a>
    </div>

    <!-- Section Patient -->
    <div *ngIf="isPatient && isLoggedIn">
      <div *ngIf="!isCollapsed" class="section-title px-3 py-2 text-blue-300 text-sm font-semibold uppercase tracking-wider">
        Mon Espace
      </div>

      <a class="nav-item flex items-center px-3 py-3 rounded-lg text-blue-100 hover:bg-blue-700 hover:text-white transition-colors"
         routerLink="/mes-pat-rendezvous"
         routerLinkActive="bg-blue-900 text-white">
        <i class="fas fa-calendar w-5 mr-3 text-center"></i>
        <span *ngIf="!isCollapsed">Mes Rendez-vous</span>
      </a>

<!--      <a class="nav-item flex items-center px-3 py-3 rounded-lg text-blue-100 hover:bg-blue-700 hover:text-white transition-colors"-->
<!--         routerLink="/mes-pat-consultations"-->
<!--         routerLinkActive="bg-blue-900 text-white">-->
<!--        <i class="fas fa-file-medical w-5 mr-3 text-center"></i>-->
<!--        <span *ngIf="!isCollapsed">Mes Consultations</span>-->
<!--      </a>-->

      <a class="nav-item flex items-center px-3 py-3 rounded-lg text-blue-100 hover:bg-blue-700 hover:text-white transition-colors"
         routerLink="/mon-pat-dossier-medical"
         routerLinkActive="bg-blue-900 text-white">
        <i class="fas fa-folder w-5 mr-3 text-center"></i>
        <span *ngIf="!isCollapsed">Mon Dossier</span>
      </a>

      <a class="nav-item flex items-center px-3 py-3 rounded-lg text-blue-100 hover:bg-blue-700 hover:text-white transition-colors"
         routerLink="/mes-pat-paiements"
         routerLinkActive="bg-blue-900 text-white">
        <i class="fas fa-money-bill w-5 mr-3 text-center"></i>
        <span *ngIf="!isCollapsed">Mes Paiements</span>
      </a>
    </div>

    <!-- Section Compte -->
    <div *ngIf="isLoggedIn" class="pt-4 border-t border-blue-700">
      <div *ngIf="!isCollapsed" class="section-title px-3 py-2 text-blue-300 text-sm font-semibold uppercase tracking-wider">
        Compte
      </div>

      <a class="nav-item flex items-center px-3 py-3 rounded-lg text-blue-100 hover:bg-blue-700 hover:text-white transition-colors"
         routerLink="/profile"
         routerLinkActive="bg-blue-900 text-white">
        <i class="fas fa-user-edit w-5 mr-3 text-center"></i>
        <span *ngIf="!isCollapsed">Mon Profil</span>
      </a>

      <a class="nav-item flex items-center px-3 py-3 rounded-lg text-red-300 hover:bg-red-600 hover:text-white transition-colors cursor-pointer"
         (click)="logout()">
        <i class="fas fa-sign-out-alt w-5 mr-3 text-center"></i>
        <span *ngIf="!isCollapsed">Déconnexion</span>
      </a>
    </div>

    <!-- Connexion (non connecté) -->
    <div *ngIf="!isLoggedIn" class="pt-4">
      <a class="nav-item flex items-center px-3 py-3 rounded-lg text-blue-100 hover:bg-blue-700 hover:text-white transition-colors"
         routerLink="/login">
        <i class="fas fa-sign-in-alt w-5 mr-3 text-center"></i>
        <span *ngIf="!isCollapsed">Connexion</span>
      </a>
    </div>
  </nav>

  <!-- Version réduite (seulement les icônes) -->
  <div *ngIf="isCollapsed" class="p-2 space-y-2">
    <!-- Dashboard -->
    <a *ngIf="isLoggedIn"
       class="w-10 h-10 flex items-center justify-center rounded-lg text-blue-100 hover:bg-blue-700 hover:text-white transition-colors"
       routerLink="/dashboard"
       [title]="'Dashboard'">
      <i class="fas fa-home"></i>
    </a>

    <!-- Admin icônes -->
    <div *ngIf="isAdmin && isLoggedIn" class="space-y-1">
      <a class="w-10 h-10 flex items-center justify-center rounded-lg text-blue-100 hover:bg-blue-700 hover:text-white transition-colors"
         routerLink="/users"
         [title]="'Utilisateurs'">
        <i class="fas fa-users"></i>
      </a>
      <a class="w-10 h-10 flex items-center justify-center rounded-lg text-blue-100 hover:bg-blue-700 hover:text-white transition-colors"
         routerLink="/medecins"
         [title]="'Médecins'">
        <i class="fas fa-user-md"></i>
      </a>
      <a class="w-10 h-10 flex items-center justify-center rounded-lg text-blue-100 hover:bg-blue-700 hover:text-white transition-colors"
         routerLink="/secretaires"
         [title]="'Secrétaires'">
        <i class="fas fa-id-card"></i>
      </a>
    </div>

    <!-- Déconnexion icône -->
    <a *ngIf="isLoggedIn"
       class="w-10 h-10 flex items-center justify-center rounded-lg text-red-300 hover:bg-red-600 hover:text-white transition-colors cursor-pointer"
       (click)="logout()"
       [title]="'Déconnexion'">
      <i class="fas fa-sign-out-alt"></i>
    </a>

    <!-- Connexion icône -->
    <a *ngIf="!isLoggedIn"
       class="w-10 h-10 flex items-center justify-center rounded-lg text-blue-100 hover:bg-blue-700 hover:text-white transition-colors"
       routerLink="/login"
       [title]="'Connexion'">
      <i class="fas fa-sign-in-alt"></i>
    </a>
  </div>
</div>

<!-- Overlay pour mobile -->
<div *ngIf="!isCollapsed" class="fixed inset-0 bg-black bg-opacity-50 z-40 md:hidden"
     (click)="toggleSidebar()"></div>
